# yourConnector 运维与工具管理：能力总览与代码边界

## 1. 文档目标

1. 明确运维页（Ops）在当前版本承担的职责边界。
2. 用代码事实定义“连接、接入、控制、补偿删除”能力。
3. 作为后续运维能力扩展的对齐基线。

## 2. 能力范围

运维域覆盖以下能力：

1. 宿主机连接管理：连接、断开、自动重连、手动重连。
2. 宿主机总览展示：Banner 卡片、白点索引、宿主机负载弹窗。
3. 工具接入管理：候选刷新、接入、断开、改名、左滑操作。
4. 控制端授权收敛：自动重绑与失败提示。
5. 工具进程控制：`stop` / `restart`（受工具类型约束）。
6. 宿主机删除补偿：先隐藏、后重试吊销、可手工重试与强制移除。

## 3. 关键设计决策

1. 页面层先保证“操作可达”，再保证“快照实时”：左滑展开时延迟低优先级快照重渲染。
2. 连接采用“固定间隔 + 最大次数”策略：超限后转人工确认，避免无限重连。
3. 工具接入采用“发送即占位 + 回执收敛”：减轻用户等待感知。
4. 删除宿主机采用“最终一致性补偿”：即便 Relay 暂不可达也不阻塞 UI 删除动作。

## 4. 代码边界

移动端运维主链路：

1. `app/mobile/ui/js/flows/connection.js`
2. `app/mobile/ui/js/flows/connection-socket.js`
3. `app/mobile/ui/js/flows/connection-socket-events.js`
4. `app/mobile/ui/js/flows/connection-events.js`
5. `app/mobile/ui/js/flows/tool-manage.js`
6. `app/mobile/ui/js/flows/host-manage.js`
7. `app/mobile/ui/js/flows/host-delete.js`
8. `app/mobile/ui/js/flows/host-delete-remote.js`
9. `app/mobile/ui/js/views/ops.js`
10. `app/mobile/ui/js/views/banner.js`
11. `app/mobile/ui/js/views/tools.js`

服务端配合链路：

1. `services/sidecar/src/control.rs`
2. `services/sidecar/src/session/loop/command.rs`
3. `services/sidecar/src/session/snapshots.rs`

## 5. 非目标（当前版本）

1. 不提供 Web 后台运维页面；仅移动端运维入口。
2. 不做多策略重连（当前仅固定 `2s` 间隔）。
3. 不提供批量工具接入/断开事务；当前按工具单条回执收敛。
