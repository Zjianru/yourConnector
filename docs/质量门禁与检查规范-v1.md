# yourConnector 质量门禁与检查规范 v1

## 1. 目标

1. 将“代码风格、注释完整性、文档一致性、编译与测试”固化为阻断型门禁。
2. 保证重构与迭代不会破坏既有行为基线。

## 2. 阻断型门禁命令

在仓库根目录执行：

```bash
cd /Users/codez/develop/yourConnector
make check-all
```

`make check-all` 聚合以下检查：

1. `cargo check --workspace`
2. `cargo fmt --check`
3. `cargo clippy --workspace --all-targets -- -D warnings`
4. `cargo test --workspace`
5. `find /Users/codez/develop/yourConnector/app/mobile/ui/js -name '*.js' -print0 | xargs -0 -n1 node --check`
6. `make check-governance`

## 3. 治理门禁内容

`make check-governance` 包含两部分：

1. `scripts/check-governance.sh`
   - 业务源码文件头注释检查。
   - 业务函数头注释检查（JS JSDoc / Rust `///`）。
   - 行长检查（默认 `<=140`，可用 `YC_MAX_LINE_LEN` 调整）。
2. `scripts/check-doc-consistency.sh`
   - 必需文档存在性检查。
   - 文档导航收录完整性检查。
   - 绝对路径引用有效性检查。

## 4. 执行时机

1. 本地开发：提交前至少执行一次 `make check-all`。
2. 大规模重构：每个阶段结束后执行 `make check-governance`。
3. 发布前：必须执行完整 `make check-all` 并保留结果。

## 5. 失败处理规则

1. 任一命令失败即视为不可提交状态。
2. 不允许通过删除门禁脚本、放宽阈值、临时注释掉检查来规避失败。
3. 如需修改门禁标准，必须先更新：
   - `/Users/codez/develop/yourConnector/docs/代码治理与注释规范-v1.md`
   - `/Users/codez/develop/yourConnector/docs/文档导航-v2.md`

## 6. 与验收的关系

1. 功能验收执行文档为：
   `/Users/codez/develop/yourConnector/docs/已完成功能验收-v1.md`
2. 门禁通过是进入功能验收的前置条件，不可跳过。
